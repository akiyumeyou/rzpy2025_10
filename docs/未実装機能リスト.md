# 初期仕様に対する未実装機能リスト

**作成日**: 2025年9月30日  
**対象仕様書**: `docs/system_specification.md` v2.0

このドキュメントは、初期のシステム仕様書（`system_specification.md`）で計画されていた機能のうち、現在未実装または部分実装の項目を整理したものです。

---

## 1. 時報機能（部分実装）

### 仕様書の要求
- **2.1 時報機能**: 1日1回の会話開始合図として時報音を再生
- 現在時刻を音声でお知らせして自然に会話へ導入
- **スケジュール**: 将来的に定時実行機能を追加予定

### 現在の実装状況
- ✅ 時間帯別の挨拶機能は実装済み（main.py）
- ⚠️ スケジューラーモジュール（scheduler.py）は実装済みだが、main.pyに統合されていない
- ❌ **定時自動実行は未完了**（手動実行のみ）
- ❌ 時報音の再生機能は未実装（音声での時刻アナウンスのみ）

### 未実装項目
- [ ] 定時実行機能のmain.pyへの統合
- [ ] システム起動時の自動実行設定
- [ ] 時報音（ビープ音など）の再生機能

---

## 2. 終了機能（部分実装）

### 仕様書の要求
- **2.3.1 終了コマンド**:
  - 音声コマンド: 「終わり」「おしまい」「さようなら」
  - キーボード: Ctrl+C、**ESCキー**
  - 安全確認: 終了前に確認メッセージ
- **2.3.2 終了処理**:
  - 「ありがとうございました。また明日お話ししましょう。」のメッセージ
  - **データの保存（将来機能）**
  - 完全なシステム終了

### 現在の実装状況
- ✅ 音声終了コマンド（「終わり」「おしまい」「さようなら」など）は実装済み
- ✅ Ctrl+Cによる強制終了は実装済み
- ✅ 終了メッセージは一部実装（AIが挨拶）
- ✅ データの保存は実装済み（会話記録・感情分析結果）

### 未実装項目
- [ ] ESCキーによる終了機能
- [ ] 終了前の確認メッセージ（「本当に終了しますか？」）
- [ ] 終了時の音声メッセージ再生（「ありがとうございました。また明日お話ししましょう。」）

---

## 3. エラーハンドリング（大部分未実装）

### 仕様書の要求（セクション5）

#### 5.1 音声認識エラー
- 聞き取れない場合の再試行
- 「もう一度お話しください」のメッセージ
- 最大試行回数の設定

#### 5.2 ネットワークエラー
- **オフライン時の基本機能継続**
- エラーメッセージの表示
- **代替機能の提供**

#### 5.3 システムエラー
- 安全な終了処理
- エラーログの記録
- **復旧手順の案内**

### 現在の実装状況
- ✅ エラーログの記録は実装済み（logger.py）
- ✅ 音声認識失敗時の聞き返し機能は部分実装（audio_handler.py）
- ⚠️ ネットワークエラー時の表示はあるが、再接続処理は未実装
- ⚠️ 安全な終了処理は部分実装

### 未実装項目

#### 音声認識エラー対応
- [ ] 音声認識の最大試行回数設定
- [ ] 試行回数超過時の適切なメッセージ
- [ ] 音声認識精度が低い場合の警告

#### ネットワークエラー対応
- [ ] ネットワーク切断の自動検知
- [ ] 自動再接続処理
- [ ] オフライン時の基本機能継続（ローカル会話記録のみなど）
- [ ] 代替機能の提供（簡易会話モードなど）

#### システムエラー対応
- [ ] 復旧手順の音声案内
- [ ] エラー発生時の詳細な状況記録
- [ ] クラッシュ時の自動再起動機能

---

## 4. セキュリティ仕様（部分実装）

### 仕様書の要求（セクション6）

#### 6.1 プライバシー保護
- 音声データの適切な処理
- 個人情報の保護
- **データ保存の最小化**

#### 6.2 安全性
- 不正終了の防止
- **適切な権限設定**
- セキュアな通信（API使用時）

### 現在の実装状況
- ✅ OpenAI APIとの通信はHTTPS/WSS（暗号化済み）
- ✅ 音声データはストリーミング処理（一時保存なし）
- ⚠️ データベース（SQLite）への会話記録は暗号化なし
- ⚠️ 認証ファイルの保護は手動設定に依存

### 未実装項目
- [ ] データベースの暗号化
- [ ] 個人情報のマスキング機能
- [ ] データ保存期間の自動管理（古い記録の削除）
- [ ] 認証ファイルの権限チェック機能
- [ ] アクセスログの記録

---

## 5. Raspberry Pi 運用機能（未実装）

### 仕様書の要求（セクション3.1、7）
- **対象プラットフォーム**: Raspberry Pi 5（本格運用）
- 自動起動設定
- 定時実行機能

### 現在の実装状況
- ✅ macOS での開発・動作確認は完了
- ❌ Raspberry Pi での動作確認は未実施
- ❌ 自動起動設定は未実装

### 未実装項目
- [ ] Raspberry Pi 5 での動作確認
- [ ] PyAudioのRaspberry Pi対応確認
- [ ] 音声デバイス（マイク・スピーカー）の設定ガイド
- [ ] systemdサービスファイルの作成
- [ ] OS起動時の自動実行設定
- [ ] Raspberry Pi用のセットアップスクリプト
- [ ] ハードウェア要件のドキュメント化

---

## 6. ユーザーインターフェース（部分実装）

### 仕様書の要求（セクション4）

#### 4.1 起動画面
- シンプルなコンソール画面
- 起動状態の表示
- 時報と会話開始の案内

#### 4.2 会話中画面
- 最小限の情報表示
- 現在の状態（聞いています／話しています）
- 終了コマンドの案内

#### 4.3 音声フィードバック
- 明確な応答音
- 聞き取りやすい音声出力
- 適切な音量とスピード

### 現在の実装状況
- ✅ コンソール画面での基本的な情報表示は実装済み
- ✅ 音声認識・応答の状態ログは実装済み
- ⚠️ 視覚的なフィードバックは最小限
- ⚠️ 音量・スピード調整機能は未実装

### 未実装項目
- [ ] 起動時の分かりやすい案内メッセージ
- [ ] リアルタイムでの会話状態表示（聞いています／話していますのインジケーター）
- [ ] 終了コマンドの常時表示
- [ ] 音量調整機能
- [ ] 音声スピード調整機能
- [ ] 視覚的な状態インジケーター（LED表示など）

---

## 7. 将来拡張機能（未実装）

### 仕様書で言及されている将来機能

これらは現在の仕様書でも「将来機能」として位置づけられているため、未実装は想定内です。

- [ ] Webダッシュボード（会話履歴の可視化）
- [ ] 多言語対応
- [ ] ビデオ通話機能
- [ ] バイタルデータ連携（健康デバイスとの連携）
- [ ] 複数ユーザー管理機能
- [ ] カスタマイズ可能な会話プロンプト設定UI
- [ ] 音声出力の声質変更機能
- [ ] 外部家族アプリとの連携

---

## 8. ドキュメント（一部未整備）

### 仕様書で要求されている内容

- ✅ システム仕様書（`system_specification.md`）: 整備済み
- ✅ 実装手順書（`implementation_guide.md`）: 今回更新
- ✅ プロンプト設計書（`prompt_design.md`）: 整備済み
- ⚠️ README.md: 今回更新

### 未整備のドキュメント
- [ ] API仕様書（各モジュールの詳細API）
- [ ] Raspberry Piセットアップガイド
- [ ] トラブルシューティングガイドの充実
- [ ] 家族向けユーザーマニュアル
- [ ] 開発者向けコントリビューションガイド

---

## まとめ

### 優先度：高（実運用に必須）

1. **定時自動実行機能の統合** - スケジューラーをmain.pyに統合
2. **Raspberry Pi対応** - 動作確認と自動起動設定
3. **ネットワークエラー対応** - 再接続処理の実装
4. **音声フィードバックの改善** - 音量・スピード調整

### 優先度：中（機能向上に有用）

5. **エラーハンドリングの強化** - 音声認識・システムエラー対応
6. **終了機能の完全実装** - 確認メッセージ、音声案内
7. **セキュリティ強化** - データベース暗号化、認証ファイル保護
8. **ユーザーインターフェースの改善** - 状態表示、案内メッセージ

### 優先度：低（将来的に検討）

9. **Webダッシュボード** - 家族向け可視化機能
10. **多言語対応**
11. **外部デバイス連携**

---

**備考**: 現在のシステムは、手動実行での安否確認システムとしては**実用レベル**に達していますが、完全自動運用にはPhase 4（定時実行統合）とRaspberry Pi対応が必須です。
